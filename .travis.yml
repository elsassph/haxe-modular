language: haxe

haxe:
  - 3.4.7
  - 4.0.5
  - 4.1.5
  - stable
  - development

matrix:
  allow_failures:
    - haxe: development

install:
  - echo "{\"version\":\"$(dirname `which haxe`)\", \"resolveLibs\":\"scoped\"}" > .haxerc
  - node -v && npm install

before_script:
  # - npm run build

script:
  - npm run test
  - npm run test -- es6

deploy:
  - provider: script
    script: bash ./releaseHaxelib.sh $HAXELIB_PWD
    on:
      haxe: stable
      tags: true
  - provider: npm
    email: "philippe.elsass@gmail.com"
    api_key: $NPM_KEY
    on:
      haxe: stable
      tags: true
